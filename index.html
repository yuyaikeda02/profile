<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>池田 悠耶(Yuya Ikeda) - Home</title>
  <link rel="stylesheet" href="./style.css">

  <style>
    /* 共通スタイル */
    body.index-page { background: #ffffff; font-family: "Noto Sans JP", sans-serif; margin: 0; }
    .index-works { padding: 40px 24px; width: 100%; display: flex; flex-direction: column; align-items: center; min-height: 80vh; }
    .master-container { position: relative; padding: 50px; }
    
    /* スライダー */
    .index-image-container { position: relative; width: 500px; max-width: 100%; aspect-ratio: 16 / 9; overflow: hidden; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); z-index: 5; background: #eee;}
    .sub-image-container { position: absolute; width: 120px; height: 120px; overflow: hidden; border-radius: 16px; box-shadow: 0 8px 25px rgba(0,0,0,0.2); border: 3px solid #fff; z-index: 10; background: #000; }
    .top-left { top: 0; left: 0; } .top-right { top: 0; right: 0; } .bottom-left { bottom: 0; left: 0; } .bottom-right { bottom: 0; right: 0; }
    
    .index-works-slider, .sub-works-slider { display: flex; height: 100%; transition: transform 0.7s cubic-bezier(0.4, 0, 0.2, 1); will-change: transform; }
    .index-work-item { flex-shrink: 0; width: 100%; height: 100%; }
    .index-work-image { width: 100%; height: 100%; object-fit: cover; display: block; }
    
    .index-image-container .index-work-item { min-width: 500px; }
    .sub-image-container .index-work-item { min-width: 120px; }

    @media (max-width: 600px) {
      .index-image-container { width: 300px; }
      .index-image-container .index-work-item { min-width: 300px; }
      .sub-image-container { width: 80px; height: 80px; }
      .sub-image-container .index-work-item { min-width: 80px; }
    }
  </style>
</head>
<body class="index-page">
<header>
    <nav class="nav">
      <div class="brand">池田 悠耶(Yuya Ikeda)</div>
      <div class="menu">
        <a class="active" href="./index.html">ホーム</a>
        <a href="./profile.html">プロフィール</a>
        <a href="./research.html">研究</a>
        <a href="./daily.html">日常</a>
        <a href="./others.html">他</a>
      </div>
    </nav>
  </header>

  <main>
    <section class="index-works">
      <div class="master-container">
        <div class="index-image-container">
          <div class="index-works-slider" id="mainSlider"></div>
        </div>
        <div class="sub-image-container top-left"><div class="sub-works-slider" id="sub1"></div></div>
        <div class="sub-image-container top-right"><div class="sub-works-slider" id="sub2"></div></div>
        <div class="sub-image-container bottom-left"><div class="sub-works-slider" id="sub3"></div></div>
        <div class="sub-image-container bottom-right"><div class="sub-works-slider" id="sub4"></div></div>
      </div>
    </section>
  </main>

  <footer><div>© 2025 Yuya Ikeda</div></footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, orderBy, query } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    // ★ここにFirebase Configを貼り付け★
    const firebaseConfig = {
      apiKey: "AIzaSyAOXZbiMIA4QWZvIeAeuWJUgf9Cig4-QGg",
  authDomain: "myprofile-555d3.firebaseapp.com",
  projectId: "myprofile-555d3",
  storageBucket: "myprofile-555d3.firebasestorage.app",
  messagingSenderId: "544294059424",
  appId: "1:544294059424:web:68484691610464609938c5",
  measurementId: "G-W69DEVZHR1"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function loadGallery() {
      const sliders = [
        document.getElementById('mainSlider'), document.getElementById('sub1'), 
        document.getElementById('sub2'), document.getElementById('sub3'), document.getElementById('sub4')
      ];
      
      // Firestoreから画像データを取得
      const q = query(collection(db, "photos"), orderBy("createdAt", "desc"));
      const querySnapshot = await getDocs(q);

      querySnapshot.forEach((doc) => {
        const data = doc.data();
        
        // すべてのスライダーに追加
        sliders.forEach(el => {
          const div = document.createElement('div');
          div.className = 'index-work-item';
          // タイトルがある場合はalt属性に入れる
          div.innerHTML = `<img src="${data.url}" alt="${data.title || ''}" class="index-work-image">`;
          el.appendChild(div);
        });
      });

      // アニメーション開始
      startAnimation(sliders.map(el => ({ el })));
    }

    let timer;
    function startAnimation(sliders) {
      if(timer) clearInterval(timer);
      function updateSlider(s) {
        const items = s.el.querySelectorAll('.index-work-item');
        if (!items.length) return;
        const idx = Math.floor(Math.random() * items.length);
        const w = items[0].offsetWidth || s.el.parentElement.offsetWidth;
        s.el.style.transform = `translateX(-${idx * w}px)`;
      }
      function run() { sliders.forEach(s => updateSlider(s)); }
      setTimeout(run, 1000); // 描画待ち
      timer = setInterval(run, 5000); // 5秒ごとにスライド
      window.addEventListener('resize', run);
    }

    loadGallery();
  </script>
</body>
</html>